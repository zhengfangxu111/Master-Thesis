"0","# Install and load necessary packages"
"0","library(ggplot2)"
"0",""
"0","# Read the CSV file"
"0","setwd(""D:/GIVA/project/trajectory_analysis/data"")"
"2","Warning: The working directory was changed to D:/GIVA/project/trajectory_analysis/data inside a notebook chunk. The working directory will be reset when the chunk is finished running. Use the knitr root.dir option in the setup chunk to change the working directory for notebook chunks."
"0","data_trajectory <- read.csv(""trajectory_analysis.csv"")"
"0",""
"0","# Calculate the sum total_length and sum total_duration for each scenario"
"0","sum_data <- aggregate(cbind(total_length, total_duration) ~ scenario, data = data_trajectory, sum, na.rm = TRUE)"
"0",""
"0","# Calculate average speed (sum length / sum duration)"
"0","sum_data$average_speed <- sum_data$total_length / sum_data$total_duration"
"0",""
"0","# Map scenario labels"
"0","sum_data$scenario_label <- factor(sum_data$scenario, levels = c(1, 2, 3, 4),"
"0","                                   labels = c(""LT-Non-A"", ""LT-Adapt"", ""HT-Non-A"", ""HT-Adapt""))"
"0",""
"0","# Define color mapping using hexadecimal color codes"
"0","scenario_colors <- c(""LT-Non-A"" = ""#008837"",  # Dark Green"
"0","                     ""LT-Adapt"" = ""#a6dba0"",  # Light Green"
"0","                     ""HT-Non-A"" = ""#7b3294"",  # Dark Slate Blue"
"0","                     ""HT-Adapt"" = ""#c2a5cf"")  # Lavender"
"0",""
"0","# Create a ggplot with average speed for each scenario"
"0","plot_speed <- ggplot(sum_data, aes(x = scenario_label, y = average_speed, fill = scenario_label)) +"
"0","  geom_bar(stat = ""identity"", position = ""dodge"", color = ""black"") +"
"0","  geom_text(aes(label = round(average_speed, 2)), vjust = -0.5, size = 3, color = ""black"") +  # Add labels on top"
"0","  labs(title = ""Average Speed for Each Scenario"","
"0","       x = ""Scenario"","
"0","       y = ""Average Speed"") +"
"0","  scale_fill_manual(values = scenario_colors, name = ""Scenario"") +"
"0","  theme_minimal()"
"0",""
"0","# Show the speed plot"
"0","print(plot_speed)"
"0",""
