"0","# Install and load necessary packages"
"0","library(ggplot2)"
"0",""
"0","# Read the CSV file"
"0","data_trajectory <- read.csv(""trajectory_analysis.csv"")"
"0",""
"0","# Calculate the sum total_walkingstops for each scenario"
"0","sum_walkingstops <- aggregate(total_walkingstops ~ scenario, data = data_trajectory, sum, na.rm = TRUE)"
"0",""
"0","# Calculate average number of total_walkingstops"
"0","sum_walkingstops$average_walkingstops <- sum_walkingstops$total_walkingstops /                                           length(unique(data_trajectory$participantno[data_trajectory$scenario %in% sum_walkingstops$scenario]))"
"0",""
"0",""
"0","# Map scenario labels"
"0","sum_walkingstops$scenario_label <- factor(sum_walkingstops$scenario, levels = c(1, 2, 3, 4),"
"0","                                           labels = c(""LT-Non-A"", ""LT-Adapt"", ""HT-Non-A"", ""HT-Adapt""))"
"0",""
"0","# Define color mapping using hexadecimal color codes"
"0","scenario_colors <- c(""LT-Non-A"" = ""#008837"",  # Dark Green"
"0","                     ""LT-Adapt"" = ""#a6dba0"",  # Light Green"
"0","                     ""HT-Non-A"" = ""#7b3294"",  # Dark Slate Blue"
"0","                     ""HT-Adapt"" = ""#c2a5cf"")  # Lavender"
"0",""
"0","# Create a ggplot with average number of total_walkingstops for each scenario"
"0","plot_walkingstops <- ggplot(sum_walkingstops, aes(x = scenario_label, y = average_walkingstops, fill = scenario_label)) +"
"0","  geom_bar(stat = ""identity"", position = ""dodge"", color = ""black"") +"
"0","  geom_text(aes(label = round(average_walkingstops, 2)), vjust = -0.5, size = 3, color = ""black"") +  # Add labels on top"
"0","  labs(title = ""Average Number of Total Walking Stops for Each Scenario"","
"0","       x = ""Scenario"","
"0","       y = ""Average Walking Stops"") +"
"0","  scale_fill_manual(values = scenario_colors, name = ""Scenario"") +"
"0","  theme_minimal()"
"0",""
"0","# Show the walking stops plot"
"0","print(plot_walkingstops)"
"0",""
